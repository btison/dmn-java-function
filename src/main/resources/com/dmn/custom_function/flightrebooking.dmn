<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<dmn11:definitions xmlns="http://www.trisotech.com/definitions/_20cd5e8b-a8dd-4484-bfdf-61dfc0c30955" xmlns:feel="http://www.omg.org/spec/FEEL/20140401" xmlns:tc="http://www.omg.org/spec/DMN/20160719/testcase" xmlns:triso="http://www.trisotech.com/2015/triso/modeling" xmlns:trisofeed="http://trisotech.com/feed" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" exporter="DMN Modeler" exporterVersion="6.0.7.2" id="_20cd5e8b-a8dd-4484-bfdf-61dfc0c30955" name="passenger-rebooking" namespace="http://www.trisotech.com/definitions/_20cd5e8b-a8dd-4484-bfdf-61dfc0c30955" triso:logoChoice="Default" xmlns:dmn11="http://www.omg.org/spec/DMN/20151101/dmn.xsd">
  <dmn11:extensionElements/>
  <dmn11:itemDefinition isCollection="false" label="tFlight" name="tFlight">
    <dmn11:itemComponent id="_b2e2eedb-cce7-4b76-9051-7c5dba815c50" isCollection="false" name="Flight Number">
      <dmn11:typeRef>feel:string</dmn11:typeRef>
    </dmn11:itemComponent>
    <dmn11:itemComponent id="_946559e6-4f6a-4788-aca0-efbba0091fef" isCollection="false" name="From">
      <dmn11:typeRef>feel:string</dmn11:typeRef>
    </dmn11:itemComponent>
    <dmn11:itemComponent id="_a1e57365-0499-4dee-804e-a759d517c383" isCollection="false" name="To">
      <dmn11:typeRef>feel:string</dmn11:typeRef>
    </dmn11:itemComponent>
    <dmn11:itemComponent id="_b307886d-777d-43b0-84ee-8bdb652e0d27" isCollection="false" name="Departure">
      <dmn11:typeRef>feel:dateTime</dmn11:typeRef>
    </dmn11:itemComponent>
    <dmn11:itemComponent id="_2461a661-13d0-4abb-9e70-52b8f48c9de0" isCollection="false" name="Arrival">
      <dmn11:typeRef>feel:dateTime</dmn11:typeRef>
    </dmn11:itemComponent>
    <dmn11:itemComponent id="_72631a84-f234-4332-aa89-6ac40588264e" isCollection="false" name="Capacity">
      <dmn11:typeRef>feel:number</dmn11:typeRef>
    </dmn11:itemComponent>
    <dmn11:itemComponent id="_b1e2b910-c2cd-4bb0-b1af-e9353e16af9c" isCollection="false" name="Status">
      <dmn11:typeRef>feel:string</dmn11:typeRef>
    </dmn11:itemComponent>
  </dmn11:itemDefinition>
  <dmn11:itemDefinition isCollection="true" label="tFlightTable" name="tFlightTable">
    <dmn11:typeRef>tFlight</dmn11:typeRef>
  </dmn11:itemDefinition>
  <dmn11:itemDefinition isCollection="false" label="tPassenger" name="tPassenger">
    <dmn11:itemComponent id="_9bf1451a-3bef-4e7a-9441-b64af2cd0a7c" isCollection="false" name="Name">
      <dmn11:typeRef>feel:string</dmn11:typeRef>
    </dmn11:itemComponent>
    <dmn11:itemComponent id="_baf20588-7ad9-4671-bddf-bc790da95e99" isCollection="false" name="Status">
      <dmn11:typeRef>feel:string</dmn11:typeRef>
    </dmn11:itemComponent>
    <dmn11:itemComponent id="_fb55b032-01fd-4316-8c09-928cf2bd69a6" isCollection="false" name="Miles">
      <dmn11:typeRef>feel:number</dmn11:typeRef>
    </dmn11:itemComponent>
    <dmn11:itemComponent id="_8d345230-27ea-4dc7-9813-02755b6f366f" isCollection="false" name="Flight Number">
      <dmn11:typeRef>feel:string</dmn11:typeRef>
    </dmn11:itemComponent>
  </dmn11:itemDefinition>
  <dmn11:itemDefinition isCollection="true" label="tPassengerTable" name="tPassengerTable">
    <dmn11:typeRef>tPassenger</dmn11:typeRef>
  </dmn11:itemDefinition>
  <dmn11:itemDefinition isCollection="true" label="tFlightNumberList" name="tFlightNumberList">
    <dmn11:typeRef>feel:string</dmn11:typeRef>
  </dmn11:itemDefinition>
  <dmn11:inputData id="_bc2379a3-32ca-4a1f-9f2e-b3e3fad37377" name="Flight List">
    <dmn11:variable id="_1e9549b6-0832-4171-badd-9187f3c927e6" name="Flight List" typeRef="tFlightTable"/>
  </dmn11:inputData>
  <dmn11:inputData id="_824e8e80-d250-4e10-95e6-79f92e6ba9b1" name="Passenger List">
    <dmn11:variable id="_2b54b6c2-61b1-4a73-a06d-31af8db59e22" name="Passenger List" typeRef="tPassengerTable"/>
  </dmn11:inputData>
  <dmn11:decision id="_755845cb-1099-4ff5-a9ff-f39b93fddc16" name="Prioritized Waiting List">
    <dmn11:variable id="_b5bd5ec7-b9ff-48b1-9eb9-cdb36125257b" name="Prioritized Waiting List" typeRef="tPassengerTable"/>
    <dmn11:informationRequirement>
      <dmn11:requiredInput href="#_bc2379a3-32ca-4a1f-9f2e-b3e3fad37377"/>
    </dmn11:informationRequirement>
    <dmn11:informationRequirement>
      <dmn11:requiredInput href="#_824e8e80-d250-4e10-95e6-79f92e6ba9b1"/>
    </dmn11:informationRequirement>
    <dmn11:knowledgeRequirement>
      <dmn11:requiredKnowledge href="#_ba1c656d-a686-4678-acc7-76448de477c5"/>
    </dmn11:knowledgeRequirement>
    <dmn11:context id="_29a1e68b-b9c6-4bb4-982f-7e8fef5793e0">
      <dmn11:contextEntry>
        <dmn11:variable id="_12d58470-cf5b-4d36-be53-7bd5cfee1ecf" name="Cancelled Flights" typeRef="tFlightNumberList"/>
        <dmn11:literalExpression id="_0764db3c-e8df-4216-b8ac-a7b2a2ea0416">
          <dmn11:text>Flight List[ Status = "cancelled"].Flight Number</dmn11:text>
        </dmn11:literalExpression>
      </dmn11:contextEntry>
      <dmn11:contextEntry>
        <dmn11:variable id="_4e8fc3ab-2762-4418-969b-5b7edd19f3c1" name="Waiting List" typeRef="tPassengerTable"/>
        <dmn11:literalExpression id="_2519950a-25d2-4ae7-b1b5-369efad96396">
          <dmn11:text>Passenger List[ list contains(Cancelled Flights, Flight Number)]</dmn11:text>
        </dmn11:literalExpression>
      </dmn11:contextEntry>
      <dmn11:contextEntry>
        <dmn11:variable id="_8bc1f6f2-1d6b-4780-9baa-37282e9176a9" name="passenger priority" typeRef="feel:boolean"/>
        <dmn11:functionDefinition xmlns:drools="http://www.drools.org/kie/dmn/1.1" drools:kind="F" id="_f010556a-283d-42a6-bdde-f4751fa71859">
          <dmn11:formalParameter id="_a94ce966-1e29-4a01-a0f4-711dcc3fa2f4" name="Passenger1" typeRef="tPassenger"/>
          <dmn11:formalParameter id="_5d86134c-5675-42f4-bb0a-86fc4d636fb1" name="Passenger2" typeRef="tPassenger"/>
          <dmn11:literalExpression id="_23add5e0-6f53-419f-b046-941943931877">
            <dmn11:text>status priority(Passenger1.Status) &lt; status priority(Passenger2.Status) or
              (status priority(Passenger1.Status) = status priority(Passenger2.Status)
              and Passenger1.Miles &gt; Passenger2.Miles)</dmn11:text>
          </dmn11:literalExpression>
        </dmn11:functionDefinition>
      </dmn11:contextEntry>
      <dmn11:contextEntry>
        <dmn11:literalExpression id="_d176402f-95d2-4f95-84c9-74c1e6f19efc">
          <dmn11:text>sort(Waiting List, passenger priority)</dmn11:text>
        </dmn11:literalExpression>
      </dmn11:contextEntry>
    </dmn11:context>
  </dmn11:decision>
  <dmn11:decision id="_9da56a0b-f267-49c3-8366-4a6be4b1dff4" name="Rebooked Passengers">
    <dmn11:variable id="_b24839c7-f832-49da-85a0-5d9b713d03c0" name="Rebooked Passengers" typeRef="tPassengerTable"/>
    <dmn11:informationRequirement>
      <dmn11:requiredDecision href="#_755845cb-1099-4ff5-a9ff-f39b93fddc16"/>
    </dmn11:informationRequirement>
    <dmn11:informationRequirement>
      <dmn11:requiredInput href="#_bc2379a3-32ca-4a1f-9f2e-b3e3fad37377"/>
    </dmn11:informationRequirement>
    <dmn11:knowledgeRequirement>
      <dmn11:requiredKnowledge href="#_0d9f7ac3-6423-4b23-bada-7c7004972314"/>
    </dmn11:knowledgeRequirement>
    <dmn11:invocation id="_d9c61f20-3cd6-4b44-838b-155f8d5a6ac6">
      <dmn11:literalExpression id="literal__d9c61f20-3cd6-4b44-838b-155f8d5a6ac6">
        <dmn11:text>rebooked flights</dmn11:text>
      </dmn11:literalExpression>
      <dmn11:binding>
        <dmn11:parameter id="_b748f37d-87db-4577-bb79-d8fc05215865" name="Waiting"/>
        <dmn11:literalExpression id="_6f72e42d-bdae-41ad-9fce-9039cd6a4284">
          <dmn11:text>Prioritized Waiting List</dmn11:text>
        </dmn11:literalExpression>
      </dmn11:binding>
      <dmn11:binding>
        <dmn11:parameter id="_598e98e6-f88e-4816-9080-a5c0efee40b6" name="Rebooked"/>
        <dmn11:literalExpression id="_6590d382-352d-4cb0-a6b9-d518de47c5a7">
          <dmn11:text>[]</dmn11:text>
        </dmn11:literalExpression>
      </dmn11:binding>
      <dmn11:binding>
        <dmn11:parameter id="_d5aaa25b-68b3-4fb5-8af1-775c9c9e5db8" name="Flights"/>
        <dmn11:literalExpression id="_ddea3508-de48-4ec4-9ff3-081e407ca60d">
          <dmn11:text>Flight List</dmn11:text>
        </dmn11:literalExpression>
      </dmn11:binding>
    </dmn11:invocation>
  </dmn11:decision>
  <dmn11:businessKnowledgeModel id="_ba1c656d-a686-4678-acc7-76448de477c5" name="status priority">
    <dmn11:encapsulatedLogic>
      <dmn11:formalParameter name="Status" typeRef="feel:string"/>
      <dmn11:decisionTable hitPolicy="UNIQUE" id="_37b84992-789d-49cf-83e8-e0d20832b6c4" outputLabel="status priority">
        <dmn11:input id="_58540ced-0559-475d-8b56-09ea06e6b031">
          <dmn11:inputExpression typeRef="feel:string">
            <dmn11:text>Status</dmn11:text>
          </dmn11:inputExpression>
          <dmn11:inputValues triso:constraintsType="enumeration">
            <dmn11:text>"gold","silver","bronze"</dmn11:text>
          </dmn11:inputValues>
        </dmn11:input>
        <dmn11:output id="_62cd292b-e868-48db-a56a-7edb5e238c41"/>
        <dmn11:rule id="_22f13e87-6732-48fa-83cb-dd702279ee3e">
          <dmn11:inputEntry id="_873628d7-8a96-4aa4-ae95-bc11ba96423b">
            <dmn11:text>"gold"</dmn11:text>
          </dmn11:inputEntry>
          <dmn11:outputEntry id="_14b78dad-ac6d-4a50-b024-5e03667c9da5">
            <dmn11:text>1</dmn11:text>
          </dmn11:outputEntry>
        </dmn11:rule>
        <dmn11:rule id="_e9093a08-f7c8-41a3-8cb8-02245f166406">
          <dmn11:inputEntry id="_64b49c9a-3870-45c3-98ea-4c71280136a9">
            <dmn11:text>"silver"</dmn11:text>
          </dmn11:inputEntry>
          <dmn11:outputEntry id="_0e2823f0-9c41-49bb-9365-34516f1a6bb2">
            <dmn11:text>2</dmn11:text>
          </dmn11:outputEntry>
        </dmn11:rule>
        <dmn11:rule id="_a5a49743-9b80-434a-9237-d8fe43bbfe1a">
          <dmn11:inputEntry id="_82d538f6-acd7-4631-8652-a601b3376dd6">
            <dmn11:text>"bronze"</dmn11:text>
          </dmn11:inputEntry>
          <dmn11:outputEntry id="_3e80187a-d545-4bb9-aded-09f4e4a0d66a">
            <dmn11:text>3</dmn11:text>
          </dmn11:outputEntry>
        </dmn11:rule>
      </dmn11:decisionTable>
    </dmn11:encapsulatedLogic>
    <dmn11:variable id="_f896fdcb-8cac-4d1a-aa4b-5e6ad2c2dab8" name="status priority" typeRef="feel:number"/>
  </dmn11:businessKnowledgeModel>
  <dmn11:businessKnowledgeModel id="_0d9f7ac3-6423-4b23-bada-7c7004972314" name="rebooked flights">
    <dmn11:encapsulatedLogic xmlns:drools="http://www.drools.org/kie/dmn/1.1" drools:kind="F" id="_580e4f92-772d-489a-acdc-1afcf620e45c">
      <dmn11:formalParameter id="_8728a2d3-e9ae-4810-8800-0f27e00d5f77" name="Waiting" typeRef="tPassengerTable"/>
      <dmn11:formalParameter id="_3396540f-2d19-4cf0-90ae-133af3c36b46" name="Rebooked" typeRef="tPassengerTable"/>
      <dmn11:formalParameter id="_55bb5f9b-4293-4795-8c84-ce13f4ddd1f1" name="Flights" typeRef="tFlightTable"/>
      <dmn11:context id="_c075c03e-7b00-466d-9a8a-10061d8c734e">
        <dmn11:contextEntry>
          <dmn11:variable id="_477adde0-0b86-4455-92d0-c2fdc9ebb946" name="Passenger" typeRef="tPassenger"/>
          <dmn11:literalExpression id="_0d05ce2c-c71c-4166-bdbe-8328c8d1068b">
            <dmn11:text>Waiting[1]</dmn11:text>
          </dmn11:literalExpression>
        </dmn11:contextEntry>
        <dmn11:contextEntry>
          <dmn11:variable id="_e1b7ceea-31e5-4526-9a50-a63fde17b9f4" name="Original Flight" typeRef="tFlight"/>
          <dmn11:literalExpression id="_6229b33c-fa49-47f0-929c-0652d329d9f7">
            <dmn11:text>Flights[ Flight Number = Passenger.Flight Number ][1]</dmn11:text>
          </dmn11:literalExpression>
        </dmn11:contextEntry>
        <dmn11:contextEntry>
          <dmn11:variable id="_f882ee13-1f35-484f-a4f4-14770a577a0e" name="has capacity" typeRef="feel:boolean"/>
          <dmn11:functionDefinition drools:kind="F" id="_b0851d7d-76ac-4242-827d-53134b5fbabd">
            <dmn11:formalParameter id="_6559cc89-20ad-4a3d-874d-5e70b3b6e1e5" name="flight" typeRef="tFlight"/>
            <dmn11:formalParameter id="_6bc2f862-c9e7-4a59-a37b-1f507a096a4b" name="rebooked list" typeRef="tPassengerTable"/>
            <dmn11:literalExpression id="_0511bf05-83a8-4c9d-94bc-91b8deee1b49">
              <dmn11:text>flight.Capacity &gt; count( rebooked list[ Flight Number = flight.Flight Number ] )</dmn11:text>
            </dmn11:literalExpression>
          </dmn11:functionDefinition>
        </dmn11:contextEntry>
        <dmn11:contextEntry>
          <dmn11:variable id="_054412c9-f20d-4102-a59f-73183d38f014" name="Best Alternate Flight" typeRef="tFlight"/>
          <dmn11:literalExpression id="_6673cad1-a075-48c1-a53c-34a62edab846">
            <dmn11:text>Flights[ From = Original Flight.From and
              To = Original Flight.To and
              Departure &gt; Original Flight.Departure and
              Status = "scheduled" and
              has capacity( item, Rebooked ) ][1]</dmn11:text>
          </dmn11:literalExpression>
        </dmn11:contextEntry>
        <dmn11:contextEntry>
          <dmn11:variable id="_fb424a0b-94e3-4007-bcab-5f6598004574" name="New Flight" typeRef="tPassenger"/>
          <dmn11:context id="_76bf6e6b-2990-49e8-b64b-3e689483865e">
            <dmn11:contextEntry>
              <dmn11:variable id="_905dd2a8-b391-4898-af47-e986b0915f23" name="Name" typeRef="feel:string"/>
              <dmn11:literalExpression id="_54c8e2cb-92fc-48af-a9e0-d0f0b7dd7f9b">
                <dmn11:text>Passenger.Name</dmn11:text>
              </dmn11:literalExpression>
            </dmn11:contextEntry>
            <dmn11:contextEntry>
              <dmn11:variable id="_708f84e6-adfc-4446-a48a-eda6d2b7b151" name="Status" typeRef="feel:string"/>
              <dmn11:literalExpression id="_f335f061-c93c-458c-aa74-4a1374465a76">
                <dmn11:text>Passenger.Status</dmn11:text>
              </dmn11:literalExpression>
            </dmn11:contextEntry>
            <dmn11:contextEntry>
              <dmn11:variable id="_c969e569-db09-49d0-8b9f-08341a1b99f8" name="Miles" typeRef="feel:number"/>
              <dmn11:literalExpression id="_1bd2dadf-825b-4e2e-94b6-17019171601d">
                <dmn11:text>Passenger.Miles</dmn11:text>
              </dmn11:literalExpression>
            </dmn11:contextEntry>
            <dmn11:contextEntry>
              <dmn11:variable id="_cfb7cbf0-4150-4254-a81a-1324df3d99f9" name="Flight Number" typeRef="feel:string"/>
              <dmn11:literalExpression id="_f61be94c-a40f-4cf5-a277-1ed832d58ddb">
                <dmn11:text>Best Alternate Flight.Flight Number</dmn11:text>
              </dmn11:literalExpression>
            </dmn11:contextEntry>
          </dmn11:context>
        </dmn11:contextEntry>
        <dmn11:contextEntry>
          <dmn11:literalExpression id="_0e5b0d9a-a572-41f0-be2e-5d010355b4f4">
            <dmn11:text>if count( Waiting ) &gt; 1
              then
              rebooked flights( remove( Waiting, 1 ), append( Rebooked, New Flight ), Flights )
              else
              append( Rebooked, New Flight )</dmn11:text>
          </dmn11:literalExpression>
        </dmn11:contextEntry>
      </dmn11:context>
    </dmn11:encapsulatedLogic>
    <dmn11:variable id="_8f1b63e8-622c-4ac5-9441-ff8a14481039" name="rebooked flights" typeRef="tPassengerTable"/>
  </dmn11:businessKnowledgeModel>
</dmn11:definitions>